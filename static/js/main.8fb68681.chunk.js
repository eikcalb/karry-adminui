(this["webpackJsonpkarry-admin"]=this["webpackJsonpkarry-admin"]||[]).push([[0],{233:function(e,t,a){e.exports=a.p+"static/media/loading_icon.1a7489ab.gif"},237:function(e,t,a){e.exports=a(557)},471:function(e,t,a){},472:function(e,t,a){},557:function(e,t,a){"use strict";a.r(t);a(238),a(169),a(287);var n,r=a(1),s=a.n(r),c=a(56),i=a.n(c),l=(a(471),a(2)),o=a(21),u=(a(472),a(5)),d=a.n(u),m=a(9),p=a(63),b=a(64),f=function(){function e(t){Object(p.a)(this,e),this.id=void 0,this.firstName=void 0,this.lastName=void 0,this.role=void 0,this.email=void 0,this.profileImageURL=void 0,this.token=void 0,this.phone=void 0,this.country=void 0,this.createdAt=void 0,this.id=t.id,this.role=t.role,this.firstName=t.firstName,this.lastName=t.lastName,this.email=t.email,this.token=t.token}return Object(b.a)(e,null,[{key:"getAllUsers",value:function(){var e=Object(m.a)(d.a.mark((function e(t){var a,n,r,s,c=arguments;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=c.length>1&&void 0!==c[1]?c[1]:1,n=c.length>2&&void 0!==c[2]?c[2]:20,e.prev=2,e.next=5,t.initiateNetworkRequest("/admin/persons/persons?pageNo=".concat(a,"&pageLimit=").concat(n),{method:"GET",referrerPolicy:"no-referrer",headers:{Accept:"application/json","x-access-token":"".concat(null===(r=t.user)||void 0===r?void 0:r.token)}});case 5:if((s=e.sent).ok){e.next=12;break}return e.t0=Error,e.next=10,s.json();case 10:throw e.t1=e.sent.error,new e.t0(e.t1);case 12:return e.next=14,s.json();case 14:return e.abrupt("return",e.sent);case 17:throw e.prev=17,e.t2=e.catch(2),e.t2;case 20:case"end":return e.stop()}}),e,null,[[2,17]])})));return function(t){return e.apply(this,arguments)}}()},{key:"updateUser",value:function(){var e=Object(m.a)(d.a.mark((function e(t,a,n){var r,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.initiateNetworkRequest("/admin/persons/persons/".concat(a),{method:"PATCH",referrerPolicy:"no-referrer",headers:{Accept:"application/json","x-access-token":"".concat(null===(r=t.user)||void 0===r?void 0:r.token),"Content-Type":"application/json"},body:JSON.stringify(n)});case 3:if((s=e.sent).ok){e.next=10;break}return e.t0=Error,e.next=8,s.json();case 8:throw e.t1=e.sent.error,new e.t0(e.t1);case 10:return e.next=12,s.json();case 12:return e.abrupt("return",e.sent);case 15:throw e.prev=15,e.t2=e.catch(0),e.t2;case 18:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"deleteUser",value:function(){var e=Object(m.a)(d.a.mark((function e(t,a){var n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.initiateNetworkRequest("/admin/persons/persons/".concat(a),{method:"DELETE",referrerPolicy:"no-referrer",headers:{Accept:"application/json","x-access-token":"".concat(null===(n=t.user)||void 0===n?void 0:n.token)}});case 3:if((r=e.sent).ok){e.next=10;break}return e.t0=Error,e.next=8,r.json();case 8:throw e.t1=e.sent.error,new e.t0(e.t1);case 10:return e.next=12,r.json();case 12:return e.abrupt("return",e.sent);case 15:throw e.prev=15,e.t2=e.catch(0),e.t2;case 18:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(t,a){return e.apply(this,arguments)}}()},{key:"warnUser",value:function(){var e=Object(m.a)(d.a.mark((function e(t,a,n,r){var s,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.initiateNetworkRequest("/admin/persons/persons/flag/".concat(a),{method:"POST",referrerPolicy:"no-referrer",headers:{Accept:"application/json","Content-Type":"application/json","x-access-token":"".concat(null===(s=t.user)||void 0===s?void 0:s.token)},body:JSON.stringify({message:n,postID:r})});case 3:if((c=e.sent).ok){e.next=10;break}return e.t0=Error,e.next=8,c.json();case 8:throw e.t1=e.sent.error,new e.t0(e.t1);case 10:return e.next=12,c.json();case 12:return e.abrupt("return",e.sent);case 15:throw e.prev=15,e.t2=e.catch(0),e.t2;case 18:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(t,a,n,r){return e.apply(this,arguments)}}()}]),e}(),h=a(90),v=a.n(h),E=a(44),g="/logout",j="/users",w="/posts",N="/dashboard",O="/login",x="/register",k="/",y="/posts/reports/:id",C="/posts/reports/",P="app.user.session",M="app.token.refresh",S=new(function(){function e(t){var a=this;Object(p.a)(this,e),this.ready=void 0,this.name="Karry Admin",this.version="1.0",this.config=void 0,this.user=void 0,this.logoutListener=void 0,this.config=t,this.ready=new Promise(function(){var e=Object(m.a)(d.a.mark((function e(t,n){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.init();case 3:return e.prev=3,e.next=6,a.inflateUser();case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(3),console.log(e.t0);case 11:t(!0),e.next=18;break;case 14:e.prev=14,e.t1=e.catch(0),console.log(e.t1),n(e.t1);case 18:case"end":return e.stop()}}),e,null,[[0,14],[3,8]])})));return function(t,a){return e.apply(this,arguments)}}())}return Object(b.a)(e,[{key:"init",value:function(){var e=Object(m.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return E.config({driver:[E.INDEXEDDB,E.LOCALSTORAGE,E.WEBSQL],name:"".concat(this.name," v").concat(this.version),version:1,storeName:"adminstore",description:""}),e.next=3,E.ready();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initiateNetworkRequest",value:function(){var e=Object(m.a)(d.a.mark((function e(t,a){var n,r,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Object(l.a)(Object(l.a)({},a),{},{mode:"cors"}),e.next=3,fetch("".concat(this.config.hostname).concat(t),a);case 3:if(401!==(n=e.sent).status){e.next=24;break}if(this.user){e.next=7;break}throw new Error("Unauthenticated access not allowed!");case 7:return e.prev=7,e.next=10,this.reauthenticate();case 10:return r=e.sent,s=r.token,this.user.token=s,a&&a.headers&&a.headers["x-access-token"]&&(a.headers["x-access-token"]=s),e.next=16,this.initiateNetworkRequest(t,a);case 16:return e.abrupt("return",e.sent);case 19:return e.prev=19,e.t0=e.catch(7),e.next=23,this.logout();case 23:throw e.t0||new Error("App session expired. Login to continue!");case 24:return e.abrupt("return",n);case 25:case"end":return e.stop()}}),e,this,[[7,19]])})));return function(t,a){return e.apply(this,arguments)}}()},{key:"reauthenticate",value:function(){var e=Object(m.a)(d.a.mark((function e(){var t,a,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,E.getItem(M);case 3:if(t=e.sent){e.next=6;break}throw new Error("Cannot refresh session. You must login to continue!");case 6:return e.next=8,this.initiateNetworkRequest("/admin/persons/refresh",{method:"POST",referrerPolicy:"no-referrer",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({token:t})});case 8:if((a=e.sent).ok){e.next=15;break}return e.t0=Error,e.next=13,a.json();case 13:throw e.t1=e.sent.error,new e.t0(e.t1);case 15:return e.next=17,a.json();case 17:return n=e.sent,e.next=20,E.setItem(M,n.refreshToken);case 20:return delete n.refreshToken,e.abrupt("return",n);case 24:throw e.prev=24,e.t2=e.catch(0),console.log(e.t2),e.t2;case 28:case"end":return e.stop()}}),e,this,[[0,24]])})));return function(){return e.apply(this,arguments)}}()},{key:"inflateUser",value:function(){var e=Object(m.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.getItem(P);case 2:if(t=e.sent){e.next=5;break}throw new Error("No session available for user!");case 5:return this.user=new f(t),e.abrupt("return",this.user);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"persistUser",value:function(){var e=Object(m.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.user){e.next=2;break}throw new Error("No user created!");case 2:return e.next=4,E.setItem(P,this.user);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"signedIn",value:function(){return this.user}},{key:"login",value:function(){var e=Object(m.a)(d.a.mark((function e(t,a){var n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.validateLogin(t,a);case 3:return e.next=5,this.initiateNetworkRequest("/admin/persons/login",{method:"POST",referrerPolicy:"no-referrer",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({email:t,password:a})});case 5:if((n=e.sent).ok){e.next=12;break}return e.t0=Error,e.next=10,n.json();case 10:throw e.t1=e.sent.error,new e.t0(e.t1);case 12:return e.next=14,n.json();case 14:return r=e.sent,e.next=17,E.setItem(M,r.refreshToken);case 17:return delete r.refreshToken,this.user=new f(r),e.next=21,this.persistUser();case 21:return e.abrupt("return",this.user);case 24:throw e.prev=24,e.t2=e.catch(0),e.t2;case 27:case"end":return e.stop()}}),e,this,[[0,24]])})));return function(t,a){return e.apply(this,arguments)}}()},{key:"validateLogin",value:function(){var e=Object(m.a)(d.a.mark((function e(t,a){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&a){e.next=2;break}throw new Error("Credentials not provided!");case 2:if((t=t.trim())&&v.a.isEmail(t)){e.next=5;break}throw new Error("Invalid username provided!");case 5:if(v.a.matches(a,/[a-zA-z0-9]{6,}/i)){e.next=7;break}throw new Error("Invalid password provided (Password must be alphanumeric and more than 6 characters)!");case 7:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"addAdmin",value:function(){var e=Object(m.a)(d.a.mark((function e(t){var a,n,r,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.validateRegister(t);case 3:return e.next=5,this.initiateNetworkRequest("/admin/persons/new",{method:"POST",referrerPolicy:"no-referrer",headers:{"Content-Type":"application/json",Accept:"application/json","x-access-token":"".concat(null===(a=this.user)||void 0===a?void 0:a.token)},body:JSON.stringify(t)});case 5:if((n=e.sent).ok){e.next=12;break}return e.t0=Error,e.next=10,n.json();case 10:throw e.t1=e.sent.error,new e.t0(e.t1);case 12:return e.next=14,n.json();case 14:return r=e.sent,s=new f(r),e.abrupt("return",s);case 19:throw e.prev=19,e.t2=e.catch(0),e.t2;case 22:case"end":return e.stop()}}),e,this,[[0,19]])})));return function(t){return e.apply(this,arguments)}}()},{key:"validateRegister",value:function(){var e=Object(m.a)(d.a.mark((function e(t){var a,n,r,s,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.email,n=t.password,r=t.firstName,s=t.lastName,c=t.passwordVerify,a&&n){e.next=3;break}throw new Error("Credentials not provided!");case 3:if(n===c){e.next=5;break}throw new Error("Passwords do not match!");case 5:if(a=a.trim(),r=r.trim(),s=s.trim(),r&&s){e.next=10;break}throw new Error("Firstname and lastname must be provided!");case 10:if(a&&v.a.isEmail(a)){e.next=12;break}throw new Error("Invalid username provided!");case 12:if(v.a.matches(n,/[a-zA-z0-9]{6,}/i)){e.next=14;break}throw new Error("Invalid password provided (Password must be alphanumeric and more than 6 characters)!");case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"logout",value:function(){var e=Object(m.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.user=void 0,E.removeItem(P),E.removeItem(M),this.logoutListener&&this.logoutListener();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}())({hostname:"http://ec2-54-89-250-240.compute-1.amazonaws.com:80"}),T=Object(r.createContext)(S),A=Object(r.createContext)({signedIn:void 0,setSignedInUser:function(){},setLoading:function(){}}),z={toolbar:{boxShadow:"-2px 2px 3px 0px #8888"}},I=a(6),L=a(74),U=a(30);function R(e){var t,a=e.hidden,c=void 0!==a&&a,i=Object(r.useState)({showMenu:!1}),u=Object(o.a)(i,2),d=u[0],m=u[1],p=Object(r.useContext)(T),b=Object(r.useContext)(A);return s.a.createElement("nav",{className:"navbar ".concat(c?"is-hidden":""),role:"navigation",style:z.toolbar},s.a.createElement("div",{className:"navbar-brand"},s.a.createElement("div",{className:"navbar-items is-flex-centered is-uppercase has-text-weight-bold px-4 py-2"},p.name),s.a.createElement("div",{role:"button",className:"navbar-burger burger ".concat(d.showMenu?"is-active":""),"aria-label":"menu","aria-expanded":"false","data-target":"navbarBasicExample",onClick:function(){clearTimeout(n),d.showMenu?m(Object(l.a)(Object(l.a)({},d),{},{showMenu:!1})):(m(Object(l.a)(Object(l.a)({},d),{},{showMenu:!0})),n=setTimeout((function(){m(Object(l.a)(Object(l.a)({},d),{},{showMenu:!1}))}),2e4))}},s.a.createElement("span",{"aria-hidden":"true"}),s.a.createElement("span",{"aria-hidden":"true"}),s.a.createElement("span",{"aria-hidden":"true"}))),s.a.createElement("div",{className:"navbar-menu ".concat(d.showMenu?"is-active":"")},p.signedIn()&&b.signedIn?s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"navbar-start"},s.a.createElement(U.c,{className:"navbar-item is-tab is-uppercase",exact:!0,to:N,activeClassName:"is-active"},"Dashboard"),s.a.createElement(U.c,{className:"navbar-item is-tab is-uppercase",to:w,activeClassName:"is-active"},"Posts"),s.a.createElement(U.c,{className:"navbar-item is-tab is-uppercase",to:j,activeClassName:"is-active"},"Users")),s.a.createElement("div",{className:"navbar-end"},s.a.createElement("div",{className:"navbar-item has-dropdown is-hoverable"},s.a.createElement("div",{className:"navbar-link is-flex-centered"},s.a.createElement(I.x,null),"\xa0 ",null===(t=p.user)||void 0===t?void 0:t.firstName),s.a.createElement("div",{className:"navbar-dropdown is-right"},s.a.createElement(U.b,{className:"navbar-item is-flex-centered",to:g},s.a.createElement(I.r,null),"\xa0 Logout"))))):s.a.createElement("div",{className:"navbar-end"},s.a.createElement("div",{className:"buttons navbar-item has-addons is-uppercase"},s.a.createElement(U.b,{to:O,className:"button is-info is-rounded is-small is-outlined"},s.a.createElement(L.a,null)," \xa0 Login"),s.a.createElement(U.b,{to:x,className:"button is-success is-rounded is-small"},s.a.createElement(I.z,null)," \xa0 Join")))))}var q=a(27),D=a(233),F=a.n(D);function B(){var e=Object(r.useContext)(T),t=Object(r.useContext)(A);return Object(r.useEffect)((function(){e.logout()}),[]),t.signedIn&&t.signedIn?s.a.createElement(he,{loading:!0}):s.a.createElement(q.a,{to:{pathname:"/"}})}var V=a(235);function J(e){var t=e.children,a=Object(V.a)(e,["children"]),n=Object(r.useContext)(T),c=Object(r.useContext)(A),i=Object(q.h)();return s.a.createElement(q.b,a,n.signedIn()&&c.signedIn?t:s.a.createElement(q.a,{to:{pathname:O,state:{from:i}}}))}function G(e){var t=e.children,a=Object(r.useContext)(T),n=Object(r.useContext)(A),c=Object(q.h)();Object(q.g)();if(a.signedIn()&&n.signedIn){var i=(c.state||{from:{pathname:"/"}}).from;return s.a.createElement(q.a,{to:i})}return t}var W=a(33);function K(){var e=Object(r.useContext)(T),t=Object(r.useContext)(A),a=Object(r.useState)({showPassword:!1,username:"",password:"",loading:!1}),n=Object(o.a)(a,2),c=n[0],i=n[1],u=Object(W.useToasts)().addToast,p=Object(r.useCallback)((function(e){i(Object(l.a)(Object(l.a)({},c),{},{username:e.target.value}))}),[c]),b=Object(r.useCallback)((function(e){i(Object(l.a)(Object(l.a)({},c),{},{password:e.target.value}))}),[c]),f=Object(r.useCallback)(function(){var a=Object(m.a)(d.a.mark((function a(n){var r;return d.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n.preventDefault(),n.stopPropagation(),a.prev=2,i(Object(l.a)(Object(l.a)({},c),{},{loading:!0})),a.next=6,e.login(c.username,c.password);case 6:r=a.sent,t.setSignedInUser(r),i(Object(l.a)(Object(l.a)({},c),{},{loading:!1})),u("Login successful!",{appearance:"success"}),a.next=16;break;case 12:a.prev=12,a.t0=a.catch(2),i(Object(l.a)(Object(l.a)({},c),{},{loading:!1})),u(a.t0.message||"Failed to login!",{appearance:"error"});case 16:case"end":return a.stop()}}),a,null,[[2,12]])})));return function(e){return a.apply(this,arguments)}}(),[c]),h=Object(r.useCallback)((function(){i((function(e){return Object(l.a)(Object(l.a)({},e),{},{showPassword:!e.showPassword})}))}),[c]);return s.a.createElement(G,null,s.a.createElement(he,null,s.a.createElement("div",{className:"container is-paddingless is-fluid is-flex is-fullheight is-flex-centered has-background-info-light"},s.a.createElement("div",{className:"columns section is-mobile is-multiline is-vcentered is-flex-centered",style:{flex:1}},s.a.createElement("div",{className:"column is-10-tablet is-12-mobile"},s.a.createElement("div",{className:"card has-radius"},s.a.createElement("div",{className:"card-content section"},s.a.createElement("div",{className:"has-text-weight-bold"},s.a.createElement(I.x,{className:"is-size-1"}),s.a.createElement("form",{className:"px-6 pt-4",onSubmit:f},s.a.createElement("div",{className:"field"},s.a.createElement("p",{className:"help is-uppercase mb-2"},"Enter your admin credentials"),s.a.createElement("div",{className:"control has-icons-left"},s.a.createElement("input",{disabled:c.loading,required:!0,value:c.username,onChange:p,placeholder:"enter your username...",className:"input",type:"text"}),s.a.createElement("span",{className:"icon is-left is-small"},s.a.createElement(I.v,null)))),s.a.createElement("div",{className:"field has-addons"},s.a.createElement("div",{className:"control has-icons-left is-expanded"},s.a.createElement("input",{disabled:c.loading,required:!0,value:c.password,onChange:b,placeholder:"enter your password...",className:"input",type:c.showPassword?"text":"password"}),s.a.createElement("span",{className:"icon is-left is-small"},s.a.createElement(I.l,null))),s.a.createElement("div",{className:"control"},s.a.createElement("button",{className:"button",type:"button",onClick:h},c.showPassword?s.a.createElement(I.i,null):s.a.createElement(I.h,null)))),s.a.createElement("button",{disabled:c.loading,type:"submit",className:"button is-info is-rounded ".concat(c.loading?"is-loading":"")},s.a.createElement(L.a,null)," \xa0 Login"))))))))))}function H(){Object(r.useContext)(A);return s.a.createElement(G,null,s.a.createElement(he,null,s.a.createElement("div",{className:"container is-paddingless is-fluid is-flex is-fullheight is-flex-centered has-background-danger-light"},s.a.createElement("div",{className:"columns section is-mobile is-multiline is-vcentered is-flex-centered",style:{flex:1}},s.a.createElement("div",{className:"column is-10-tablet is-12-mobile"},s.a.createElement("div",{className:"card has-radius"},s.a.createElement("div",{className:"card-content section"},s.a.createElement("div",{className:"has-text-weight-bold"},s.a.createElement(I.f,{className:"has-text-danger is-size-1"}),s.a.createElement("p",{className:"is-size-4"},"UNAUTHORIZED ACTION"),s.a.createElement("p",{className:"has-text-weight-normal pt-4 is-capitalized"},"Contact your admin to create an account for you!"),s.a.createElement("p",{className:"has-text-weight-normal pb-4 is-capitalized"},"If you already have an account, kindly proceed to login"),s.a.createElement(U.b,{to:O,className:"button is-info is-rounded"},s.a.createElement(L.a,null)," \xa0 Login")))))))))}function _(e){var t=e.active,a=void 0!==t&&t,n=e.children,r=e.isCard,c=void 0!==r&&r,i=e.onDismiss,l=void 0===i?function(){}:i;return s.a.createElement("div",{className:"modal ".concat(a?"is-active":"")},s.a.createElement("div",{className:"modal-background"}),s.a.createElement("div",{className:"modal-content"},n),c?null:s.a.createElement("button",{onClick:l,className:"modal-close is-large","aria-label":"close"}))}function Q(){var e=Object(r.useContext)(T),t=Object(r.useState)({loading:!1,password:"",passwordVerify:"",username:"",firstName:"",lastName:"",creatorPassword:"",showPassword:!1,showVerifyPassword:!1,showCreatorPassword:!1}),a=Object(o.a)(t,2),n=a[0],c=a[1],i=Object(W.useToasts)().addToast,u=Object(r.useCallback)((function(e){c(Object(l.a)(Object(l.a)({},n),{},{firstName:e.target.value}))}),[n]),p=Object(r.useCallback)((function(e){c(Object(l.a)(Object(l.a)({},n),{},{lastName:e.target.value}))}),[n]),b=Object(r.useCallback)((function(e){c(Object(l.a)(Object(l.a)({},n),{},{username:e.target.value}))}),[n]),f=Object(r.useCallback)((function(e){c(Object(l.a)(Object(l.a)({},n),{},{password:e.target.value}))}),[n]),h=Object(r.useCallback)((function(e){c(Object(l.a)(Object(l.a)({},n),{},{passwordVerify:e.target.value}))}),[n]),v=Object(r.useCallback)((function(e){c(Object(l.a)(Object(l.a)({},n),{},{creatorPassword:e.target.value}))}),[n]),E=Object(r.useCallback)(function(){var t=Object(m.a)(d.a.mark((function t(a){var r,s,o,u,m,p,b;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),a.stopPropagation(),t.prev=2,c(Object(l.a)(Object(l.a)({},n),{},{loading:!0})),r=n.username,s=n.password,o=n.passwordVerify,u=n.firstName,m=n.lastName,p=n.creatorPassword,t.next=7,e.addAdmin({email:r,firstName:u,lastName:m,password:s,passwordVerify:o,creatorPassword:p});case 7:b=t.sent,console.log(b,":admin created"),c(Object(l.a)(Object(l.a)({},n),{},{loading:!1})),i("Successfully created admin!",{appearance:"success"}),t.next=17;break;case 13:t.prev=13,t.t0=t.catch(2),c(Object(l.a)(Object(l.a)({},n),{},{loading:!1})),i(t.t0.message||"Failed to create admin!",{appearance:"error"});case 17:case"end":return t.stop()}}),t,null,[[2,13]])})));return function(e){return t.apply(this,arguments)}}(),[n]),g=Object(r.useCallback)((function(){c((function(e){return Object(l.a)(Object(l.a)({},e),{},{showPassword:!e.showPassword})}))}),[n]),j=Object(r.useCallback)((function(){c((function(e){return Object(l.a)(Object(l.a)({},e),{},{showVerifyPassword:!e.showVerifyPassword})}))}),[n]),w=Object(r.useCallback)((function(){c((function(e){return Object(l.a)(Object(l.a)({},e),{},{showCreatorPassword:!e.showCreatorPassword})}))}),[n]);return s.a.createElement("form",{className:"card has-radius",onSubmit:E},s.a.createElement("div",{className:"card-content"},s.a.createElement(I.p,{className:"is-size-1 mb-4"}),s.a.createElement("p",{className:"help mb-2 is-uppercase has-text-weight-bold"},"Enter New Admin Details"),s.a.createElement("div",{className:"field is-horizontal"},s.a.createElement("div",{className:"field-body"},s.a.createElement("div",{className:"field"},s.a.createElement("div",{className:"control has-icons-left"},s.a.createElement("input",{disabled:n.loading,required:!0,className:"input",onChange:u,value:n.firstName,type:"text",placeholder:"enter firstname..."}),s.a.createElement("span",{className:"icon is-small is-left"},s.a.createElement(I.A,null)))),s.a.createElement("div",{className:"field"},s.a.createElement("div",{className:"control has-icons-left"},s.a.createElement("input",{disabled:n.loading,required:!0,className:"input",onChange:p,value:n.lastName,type:"text",placeholder:"enter lastname..."}),s.a.createElement("span",{className:"icon is-small is-left"},s.a.createElement(I.A,null)))))),s.a.createElement("div",{className:"field"},s.a.createElement("div",{className:"control has-icons-left"},s.a.createElement("input",{disabled:n.loading,required:!0,className:"input",onChange:b,value:n.username,type:"text",placeholder:"enter username..."}),s.a.createElement("span",{className:"icon is-small is-left"},s.a.createElement(I.y,null)))),s.a.createElement("div",{className:"field is-horizontal"},s.a.createElement("div",{className:"field-body"},s.a.createElement("div",{className:"field has-addons"},s.a.createElement("div",{className:"control has-icons-left is-expanded"},s.a.createElement("input",{disabled:n.loading,onChange:f,required:!0,value:n.password,placeholder:"enter admin password",className:"input",type:n.showPassword?"text":"password"}),s.a.createElement("span",{className:"icon is-left is-small"},s.a.createElement(I.l,null))),s.a.createElement("div",{className:"control"},s.a.createElement("button",{className:"button",type:"button",onClick:g},n.showPassword?s.a.createElement(I.i,null):s.a.createElement(I.h,null)))),s.a.createElement("div",{className:"field has-addons"},s.a.createElement("div",{className:"control has-icons-left is-expanded"},s.a.createElement("input",{disabled:n.loading,onChange:h,required:!0,value:n.passwordVerify,placeholder:"verify password",className:"input",type:n.showVerifyPassword?"text":"password"}),s.a.createElement("span",{className:"icon is-left is-small"},s.a.createElement(I.l,null))),s.a.createElement("div",{className:"control"},s.a.createElement("button",{className:"button",type:"button",onClick:j},n.showVerifyPassword?s.a.createElement(I.i,null):s.a.createElement(I.h,null)))))),s.a.createElement("p",{className:"help is-danger is-uppercase mt-6 has-text-weight-bold"},"Enter your admin password to confirm"),s.a.createElement("div",{className:"field has-addons"},s.a.createElement("div",{className:"control has-icons-left is-expanded"},s.a.createElement("input",{disabled:n.loading,onChange:v,required:!0,value:n.creatorPassword,placeholder:"confirm admin password",className:"input",type:n.showCreatorPassword?"text":"password"}),s.a.createElement("span",{className:"icon is-left is-small"},s.a.createElement(I.l,null))),s.a.createElement("div",{className:"control"},s.a.createElement("button",{className:"button",type:"button",onClick:w},n.showCreatorPassword?s.a.createElement(I.i,null):s.a.createElement(I.h,null)))),s.a.createElement("button",{disabled:n.loading,type:"submit",className:"button mt-4 is-info is-rounded ".concat(n.loading?"is-loading":"")},s.a.createElement(I.o,null)," \xa0 Add Admin Account")))}function X(e){var t=e.icon,a=void 0===t?s.a.createElement(I.g,null):t,n=e.message,r=void 0===n?"No data available!":n,c=e.shadow,i=void 0===c||c;return s.a.createElement("div",{className:"card has-radius ".concat(i?"":"is-shadowless")},s.a.createElement("div",{className:"card-content"},s.a.createElement("span",{className:"is-size-1 has-text-danger block"},a),s.a.createElement("p",{className:"is-uppercase has-text-weight-bold is-size-7"},r)))}var Y=function(){function e(){Object(p.a)(this,e)}return Object(b.a)(e,null,[{key:"getCount",value:function(){var e=Object(m.a)(d.a.mark((function e(t){var a,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.initiateNetworkRequest("/admin/persons/count",{method:"GET",referrerPolicy:"no-referrer",headers:{Accept:"application/json","x-access-token":"".concat(null===(a=t.user)||void 0===a?void 0:a.token)}});case 3:if((n=e.sent).ok){e.next=10;break}return e.t0=Error,e.next=8,n.json();case 8:throw e.t1=e.sent.error,new e.t0(e.t1);case 10:return e.next=12,n.json();case 12:return e.abrupt("return",e.sent);case 15:throw e.prev=15,e.t2=e.catch(0),e.t2;case 18:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(t){return e.apply(this,arguments)}}()}]),e}(),Z=Intl.NumberFormat();function $(e){var t=e.name,a=e.value,n=e.loading,r=void 0!==n&&n;return s.a.createElement("div",{className:"level-item has-text-centered"},s.a.createElement("div",null,s.a.createElement("p",{className:"heading"},t),r?s.a.createElement("button",{className:"button is-white is-loading"}):s.a.createElement("p",{className:"title"},Z.format(a))))}function ee(){var e=Object(r.useContext)(T),t=Object(r.useState)({showAdminModal:!1,loadingStat:!0,users:0,teams:0,ads:0,posts:0}),a=Object(o.a)(t,2),n=a[0],c=a[1];return Object(r.useEffect)((function(){Y.getCount(e).then(function(){var e=Object(m.a)(d.a.mark((function e(t){var a,r,s,i;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.ads,r=t.posts,s=t.teams,i=t.users,c(Object(l.a)(Object(l.a)({},n),{},{loadingStat:!1,ads:a,posts:r,teams:s,users:i}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){c(Object(l.a)(Object(l.a)({},n),{},{loadingStat:!1}))}))}),[]),s.a.createElement(he,null,s.a.createElement("div",{className:"container is-fluid is-fullheight"},s.a.createElement("div",{className:"section my-4"},s.a.createElement("div",{className:"level"},s.a.createElement($,{name:"Total Users",value:n.users,loading:n.loadingStat}),s.a.createElement($,{name:"Total Teams",value:n.teams,loading:n.loadingStat}),s.a.createElement($,{name:"Total Ads",value:n.ads,loading:n.loadingStat}),s.a.createElement($,{name:"Total Posts",value:n.posts,loading:n.loadingStat})),s.a.createElement("div",{className:"mt-6 columns is-multiline is-vcentered is-flex-centered"},s.a.createElement("div",{className:"column is-4-desktop is-6-tablet"},s.a.createElement("div",{className:"card"},s.a.createElement("div",{className:"card-content"},s.a.createElement("div",{className:"block has-text-weight-bold is-size-7 is-uppercase"},s.a.createElement("p",null,"Add a new admin to manage ",e.name)),s.a.createElement("div",{onClick:function(){return c(Object(l.a)(Object(l.a)({},n),{},{showAdminModal:!0}))},className:"control"},s.a.createElement("button",{className:"button is-size-7 is-dark is-fullwidth is-rounded is-uppercase"},"Create a new admin")))))))),s.a.createElement(_,{active:n.showAdminModal,onDismiss:function(){return c(Object(l.a)(Object(l.a)({},n),{},{showAdminModal:!1}))}},s.a.createElement(Q,null)))}var te=a(57),ae=a(110),ne=a.n(ae);function re(e){var t=e.user,a=e.onCancel,n=Object(r.useContext)(T),c=Object(r.useState)(Object(l.a)(Object(l.a)({user:t},t),{},{loading:!1,showEdit:!1})),i=Object(o.a)(c,2),u=i[0],p=i[1],b=Object(W.useToasts)().addToast,h=Object(r.useCallback)((function(e){p(Object(l.a)(Object(l.a)({},u),{},{firstName:e.target.value}))}),[u]),v=Object(r.useCallback)((function(e){p(Object(l.a)(Object(l.a)({},u),{},{lastName:e.target.value}))}),[u]),E=Object(r.useCallback)((function(e){p(Object(l.a)(Object(l.a)({},u),{},{email:e.target.value}))}),[u]),g=Object(r.useCallback)((function(e){p(Object(l.a)(Object(l.a)({},u),{},{country:e.target.value}))}),[u]),j=Object(r.useCallback)((function(e){p(Object(l.a)(Object(l.a)({},u),{},{phone:e.target.value}))}),[u]),w=Object(r.useCallback)(function(){var e=Object(m.a)(d.a.mark((function e(a){var r,s,c,i,o,m,h;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),a.stopPropagation(),e.prev=2,p(Object(l.a)(Object(l.a)({},u),{},{loading:!0})),r=u.user,s=r.firstName,c=r.lastName,i=r.email,o=r.phone,m=r.country,h={firstName:u.firstName,lastName:u.lastName,email:u.email,phone:u.phone,country:u.country},JSON.stringify({firstName:s,lastName:c,email:i,phone:o,country:m})!==JSON.stringify(h)){e.next=8;break}throw new Error("No change made!");case 8:return e.next=10,f.updateUser(n,t.id,h);case 10:e.sent,p(Object(l.a)(Object(l.a)({},u),{},{user:Object(l.a)(Object(l.a)({},u.user),h),showEdit:!1,loading:!1})),b("Successfully updated user!",{appearance:"success"}),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(2),p(Object(l.a)(Object(l.a)({},u),{},{loading:!1})),b(e.t0.message||"Failed to update user!",{appearance:"error"});case 19:case"end":return e.stop()}}),e,null,[[2,15]])})));return function(t){return e.apply(this,arguments)}}(),[u]),N=Object(r.useCallback)(Object(m.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,p(Object(l.a)(Object(l.a)({},u),{},{loading:!0})),window.confirm("Are you sure you want to delete this user?")){e.next=6;break}return p(Object(l.a)(Object(l.a)({},u),{},{loading:!1})),e.abrupt("return");case 6:return e.next=8,f.deleteUser(n,t.id);case 8:e.sent,p(Object(l.a)(Object(l.a)({},u),{},{loading:!1})),b("Successfully deleted user!",{appearance:"success"}),a(),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(0),p(Object(l.a)(Object(l.a)({},u),{},{loading:!1})),b(e.t0.message||"Failed to delete user!",{appearance:"error"});case 18:case"end":return e.stop()}}),e,null,[[0,14]])}))),[u]),O=u.user;if(!O)return s.a.createElement(X,{message:"No user selected!",icon:s.a.createElement(I.w,null)});var x=ne()(O.createdAt);return s.a.createElement("div",{className:"card has-radius"},s.a.createElement("div",{className:"card-content"},s.a.createElement("figure",{className:"image mb-4 is-128x128",style:{margin:"auto"}},s.a.createElement("img",{className:"is-rounded",style:{height:"100%"},src:O.profileImageURL})),u.showEdit?s.a.createElement("form",{onSubmit:w},s.a.createElement("div",{className:"my-6"},s.a.createElement("div",{className:"field is-horizontal"},s.a.createElement("div",{className:"field-body"},s.a.createElement("div",{className:"field"},s.a.createElement("div",{className:"control has-icons-left"},s.a.createElement("input",{disabled:u.loading,required:!0,className:"input",onChange:h,value:u.firstName,type:"text",placeholder:"enter firstname..."}),s.a.createElement("span",{className:"icon is-small is-left"},s.a.createElement(I.v,null)))),s.a.createElement("div",{className:"field"},s.a.createElement("div",{className:"control has-icons-left"},s.a.createElement("input",{disabled:u.loading,required:!0,className:"input",onChange:v,value:u.lastName,type:"text",placeholder:"enter lastname..."}),s.a.createElement("span",{className:"icon is-small is-left"},s.a.createElement(I.v,null)))))),s.a.createElement("div",{className:"field is-horizontal"},s.a.createElement("div",{className:"field-body"},s.a.createElement("div",{className:"field"},s.a.createElement("div",{className:"control has-icons-left"},s.a.createElement("input",{disabled:u.loading,required:!0,className:"input",onChange:E,value:u.email,type:"mail",placeholder:"enter email..."}),s.a.createElement("span",{className:"icon is-small is-left"},s.a.createElement(I.e,null)))),s.a.createElement("div",{className:"field"},s.a.createElement("div",{className:"control has-icons-left"},s.a.createElement("input",{disabled:u.loading,required:!0,className:"input",onChange:j,value:u.phone,type:"tel",placeholder:"enter phone number..."}),s.a.createElement("span",{className:"icon is-small is-left"},s.a.createElement(I.n,null)))))),s.a.createElement("div",{className:"field"},s.a.createElement("div",{className:"control has-icons-left"},s.a.createElement("input",{disabled:u.loading,required:!0,className:"input",onChange:g,value:u.country,type:"text",placeholder:"enter country..."}),s.a.createElement("span",{className:"icon is-small is-left"},s.a.createElement(I.k,null))))),s.a.createElement("div",{className:"field is-grouped is-grouped-centered"},s.a.createElement("div",{className:"control"},s.a.createElement("button",{onClick:function(){return p(Object(l.a)(Object(l.a)({},u),{},{showEdit:!1}))},disabled:u.loading,type:"reset",className:"button mt-4 is-dark is-outlined is-rounded is-uppercase"},s.a.createElement(I.b,null),"\xa0 Cancel")),s.a.createElement("div",{className:"control"},s.a.createElement("button",{disabled:u.loading,type:"submit",className:"button mt-4 is-success is-rounded is-uppercase ".concat(u.loading?"is-loading":"")},s.a.createElement(I.a,null),"\xa0 Save Changes")))):s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"mb-6 block"},s.a.createElement("p",{className:"is-capitalized has-text-grey-light has-text-centered"},s.a.createElement(I.c,null),"\xa0 Created ",x.fromNow()),s.a.createElement("div",{className:"columns mt-4 is-multiline"},s.a.createElement("p",{className:"is-capitalized column is-6"},s.a.createElement(I.x,null),"\xa0 ","".concat(O.firstName," ").concat(O.lastName)),s.a.createElement("p",{className:"is-lowercase column is-6"},s.a.createElement(I.e,null),"\xa0 ",O.email),s.a.createElement("p",{className:"is-capitalized column is-6"},s.a.createElement(I.n,null),"\xa0 ",O.phone),s.a.createElement("p",{className:"is-capitalized column is-6"},s.a.createElement(I.k,null),"\xa0 ",O.country))),s.a.createElement("div",{className:"field is-grouped is-grouped-centered"},s.a.createElement("div",{className:"control"},s.a.createElement("button",{onClick:a,disabled:u.loading,type:"button",className:"button mt-4 is-dark is-outlined is-rounded is-uppercase"},s.a.createElement(I.b,null),"\xa0 Back")),s.a.createElement("div",{className:"control"},s.a.createElement("button",{onClick:N,disabled:u.loading,type:"button",className:"button mt-4 is-danger is-rounded is-uppercase ".concat(u.loading?"is-loading":"")},s.a.createElement(I.u,null),"\xa0 Delete")),s.a.createElement("div",{className:"control"},s.a.createElement("button",{onClick:function(){return p(Object(l.a)(Object(l.a)({},u),{},{showEdit:!0}))},disabled:u.loading,type:"button",className:"button mt-4 is-success is-rounded is-uppercase"},s.a.createElement(I.m,null),"\xa0 Edit"))))))}Intl.NumberFormat();function se(e){var t=e.user,a=e.onClick;return s.a.createElement("div",{onClick:a,className:"column is-3-widescreen is-4-desktop is-12-mobile is-6-tablet"},s.a.createElement("div",{className:"card is-hoverable-card"},s.a.createElement("div",{className:"card-content"},s.a.createElement("figure",{className:"image mb-4 is-96x96",style:{margin:"auto"}},s.a.createElement("img",{className:"is-rounded",style:{height:"100%"},src:t.profileImageURL})),s.a.createElement("div",{className:"block"},s.a.createElement("p",{style:{textOverflow:"ellipsis"},className:"is-clipped is-size-6 has-text-weight-bold is-capitalized"},"".concat(t.firstName," ").concat(t.lastName))))))}function ce(){var e=Object(r.useContext)(T),t=Object(r.useState)({loadingMore:!1,users:new Array,selectedUser:void 0}),a=Object(o.a)(t,2),n=a[0],c=a[1],i=Object(W.useToasts)().addToast,u=Object(r.useCallback)(Object(m.a)(d.a.mark((function t(){var a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,c(Object(l.a)(Object(l.a)({},n),{},{loadingMore:!0})),t.next=4,f.getAllUsers(e,Math.max(2,Math.ceil(n.users.length/20)+1));case 4:if(!((a=t.sent).length<1)){t.next=8;break}return i("No new data to fetch!",{appearance:"info"}),t.abrupt("return",c(Object(l.a)(Object(l.a)({},n),{},{loadingMore:!1})));case 8:c(Object(l.a)(Object(l.a)({},n),{},{loadingMore:!1,users:[].concat(Object(te.a)(n.users),Object(te.a)(a))})),t.next=16;break;case 11:t.prev=11,t.t0=t.catch(0),console.log(t.t0),c(Object(l.a)(Object(l.a)({},n),{},{loadingMore:!0})),i("Failed to load new data!",{appearance:"error"});case 16:case"end":return t.stop()}}),t,null,[[0,11]])}))),[n]);return Object(r.useEffect)((function(){c(Object(l.a)(Object(l.a)({},n),{},{loadingMore:!0}));f.getAllUsers(e).then((function(e){if(e.length<1)return i("No new data to fetch!",{appearance:"info"}),c(Object(l.a)(Object(l.a)({},n),{},{loadingMore:!1}));c(Object(l.a)(Object(l.a)({},n),{},{loadingMore:!1,users:e}))})).catch((function(e){console.log(e),c(Object(l.a)(Object(l.a)({},n),{},{loadingMore:!0})),i("Failed to load new data!",{appearance:"error"})}))}),[]),s.a.createElement(he,null,s.a.createElement("div",{className:"container is-fluid mb-6"},s.a.createElement("div",{className:"section my-4"},s.a.createElement("div",{className:"columns is-multiline is-vcentered is-flex-centered"},n.users.map((function(e){return s.a.createElement(se,{key:e.id,onClick:function(){c((function(t){return Object(l.a)(Object(l.a)({},t),{},{selectedUser:e})}))},user:e})})))),s.a.createElement("div",{onClick:u,className:"button is-size-7 px-5 is-uppercase is-rounded is-dark ".concat(n.loadingMore?"is-loading":"")},"Load More")),n.selectedUser?s.a.createElement(_,{active:!0,onDismiss:function(){return c(Object(l.a)(Object(l.a)({},n),{},{selectedUser:void 0}))}},s.a.createElement(re,{onCancel:function(){return c(Object(l.a)(Object(l.a)({},n),{},{selectedUser:void 0}))},user:n.selectedUser})):null)}function ie(e){var t=Math.floor(Math.log(Math.abs(e))/Math.log(1e3)),a="KMBT"[Math.min(3,t-1)];if(t="KMBT".indexOf(a)+1,a){var n=Math.pow(10,2);return Math.round(e/Math.pow(1e3,t)*n)/n+a}return e}var le=function(){function e(){Object(p.a)(this,e),this.id=void 0,this.title=void 0,this.mediaURL=void 0,this.thumbnailURL=void 0,this.viewCount=0,this.type=void 0,this.uploadTime=void 0,this.owner=void 0,this.like=0,this.dislike=0,this.reportsCount=0}return Object(b.a)(e,null,[{key:"getAllPosts",value:function(){var e=Object(m.a)(d.a.mark((function e(t){var a,n,r,s,c=arguments;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=c.length>1&&void 0!==c[1]?c[1]:1,n=c.length>2&&void 0!==c[2]?c[2]:20,e.prev=2,e.next=5,t.initiateNetworkRequest("/admin/posts/posts?pageNo=".concat(a,"&pageLimit=").concat(n),{method:"GET",referrerPolicy:"no-referrer",headers:{Accept:"application/json","x-access-token":"".concat(null===(r=t.user)||void 0===r?void 0:r.token)}});case 5:if((s=e.sent).ok){e.next=12;break}return e.t0=Error,e.next=10,s.json();case 10:throw e.t1=e.sent.error,new e.t0(e.t1);case 12:return e.next=14,s.json();case 14:return e.abrupt("return",e.sent);case 17:throw e.prev=17,e.t2=e.catch(2),e.t2;case 20:case"end":return e.stop()}}),e,null,[[2,17]])})));return function(t){return e.apply(this,arguments)}}()},{key:"updatePost",value:function(){var e=Object(m.a)(d.a.mark((function e(t,a,n){var r,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.initiateNetworkRequest("/admin/posts/posts/".concat(a),{method:"PATCH",referrerPolicy:"no-referrer",headers:{Accept:"application/json","x-access-token":"".concat(null===(r=t.user)||void 0===r?void 0:r.token),"Content-Type":"application/json"},body:JSON.stringify({title:n})});case 3:if((s=e.sent).ok){e.next=10;break}return e.t0=Error,e.next=8,s.json();case 8:throw e.t1=e.sent.error,new e.t0(e.t1);case 10:return e.next=12,s.json();case 12:return e.abrupt("return",e.sent);case 15:throw e.prev=15,e.t2=e.catch(0),e.t2;case 18:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"getReports",value:function(){var e=Object(m.a)(d.a.mark((function e(t,a){var n,r,s,c,i=arguments;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>2&&void 0!==i[2]?i[2]:1,r=i.length>3&&void 0!==i[3]?i[3]:200,e.prev=2,e.next=5,t.initiateNetworkRequest("/admin/posts/posts/".concat(a,"/flag?pageNo=").concat(n,"&pageLimit=").concat(r),{method:"GET",referrerPolicy:"no-referrer",headers:{Accept:"application/json","x-access-token":"".concat(null===(s=t.user)||void 0===s?void 0:s.token)}});case 5:if((c=e.sent).ok){e.next=12;break}return e.t0=Error,e.next=10,c.json();case 10:throw e.t1=e.sent.error,new e.t0(e.t1);case 12:return e.next=14,c.json();case 14:return e.abrupt("return",e.sent);case 17:throw e.prev=17,e.t2=e.catch(2),e.t2;case 20:case"end":return e.stop()}}),e,null,[[2,17]])})));return function(t,a){return e.apply(this,arguments)}}()},{key:"deletePost",value:function(){var e=Object(m.a)(d.a.mark((function e(t,a){var n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.initiateNetworkRequest("/admin/posts/posts/".concat(a),{method:"DELETE",referrerPolicy:"no-referrer",headers:{Accept:"application/json","x-access-token":"".concat(null===(n=t.user)||void 0===n?void 0:n.token)}});case 3:if((r=e.sent).ok){e.next=10;break}return e.t0=Error,e.next=8,r.json();case 8:throw e.t1=e.sent.error,new e.t0(e.t1);case 10:return e.next=12,r.json();case 12:return e.abrupt("return",e.sent);case 15:throw e.prev=15,e.t2=e.catch(0),e.t2;case 18:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(t,a){return e.apply(this,arguments)}}()}]),e}();function oe(e){var t=e.post,a=e.onCancel,n=Object(r.useContext)(T),c=Object(r.useState)({post:t,title:t.title,loading:!1,showEdit:!1}),i=Object(o.a)(c,2),u=i[0],p=i[1],b=Object(r.useState)({show:!1}),h=Object(o.a)(b,2),v=h[0],E=h[1],g=Object(W.useToasts)().addToast,j=Object(r.useCallback)((function(e){p(Object(l.a)(Object(l.a)({},u),{},{title:e.target.value}))}),[u]),w=Object(r.useCallback)(function(){var e=Object(m.a)(d.a.mark((function e(a){var r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),a.stopPropagation(),e.prev=2,p(Object(l.a)(Object(l.a)({},u),{},{loading:!0})),u.title!==u.post.title){e.next=6;break}throw new Error("No change made!");case 6:return e.next=8,le.updatePost(n,t.id,u.title);case 8:r=e.sent,p(Object(l.a)(Object(l.a)({},u),{},{post:Object(l.a)(Object(l.a)({},u.post),{},{title:r.title}),showEdit:!1,loading:!1})),g("Successfully updated post!",{appearance:"success"}),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(2),p(Object(l.a)(Object(l.a)({},u),{},{loading:!1})),g(e.t0.message||"Failed to update post!",{appearance:"error"});case 17:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(t){return e.apply(this,arguments)}}(),[u]),N=Object(r.useCallback)(Object(m.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,p(Object(l.a)(Object(l.a)({},u),{},{loading:!0})),window.confirm("Are you sure you want to delete this post?")){e.next=6;break}return p(Object(l.a)(Object(l.a)({},u),{},{loading:!1})),e.abrupt("return");case 6:return e.next=8,le.deletePost(n,t.id);case 8:p(Object(l.a)(Object(l.a)({},u),{},{loading:!1})),g("Successfully deleted post!",{appearance:"success"}),a(),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(0),p(Object(l.a)(Object(l.a)({},u),{},{loading:!1})),g(e.t0.message||"Failed to delete post!",{appearance:"error"});case 17:case"end":return e.stop()}}),e,null,[[0,13]])}))),[u]),O=Object(r.useCallback)(function(){var e=Object(m.a)(d.a.mark((function e(a){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,p(Object(l.a)(Object(l.a)({},u),{},{loading:!0})),!(a.length<24)){e.next=4;break}throw new Error("Provide a meaningful message more than 24 characters!");case 4:if(window.confirm("Send a warning to this user about the content of this reported post?")){e.next=8;break}return p(Object(l.a)(Object(l.a)({},u),{},{loading:!1})),e.abrupt("return");case 8:return e.next=10,f.warnUser(n,t.owner.id,a,t.id);case 10:p(Object(l.a)(Object(l.a)({},u),{},{loading:!1})),E({show:!1}),g("Successfully sent warning to user!",{appearance:"success"}),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(0),p(Object(l.a)(Object(l.a)({},u),{},{loading:!1})),g(e.t0.message||"Failed to warn user!",{appearance:"error"});case 19:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(t){return e.apply(this,arguments)}}(),[u]),x=u.post;if(!x)return s.a.createElement(X,{message:"No Post Selected!",icon:s.a.createElement(I.q,null)});var k=ne.a.unix(x.uploadTime/1e3);return s.a.createElement("div",{className:"card has-radius"},v.show?s.a.createElement("div",{className:"card-content"},s.a.createElement(ue,{onBack:function(){return E(Object(l.a)(Object(l.a)({},v),{},{show:!1}))},onSubmit:O,loading:u.loading})):s.a.createElement("div",{className:"card-content"},s.a.createElement("figure",{className:"image",style:{margin:"auto"}},"image"===x.type?s.a.createElement("img",{style:{height:"100%"},src:x.mediaURL}):s.a.createElement("video",{controls:!0,src:x.mediaURL})),u.showEdit?s.a.createElement("form",{onSubmit:w},s.a.createElement("div",{className:"field"},s.a.createElement("p",{className:"help block has-text-weight-bold is-size-6 is-uppercase"},"Edit Post Title"),s.a.createElement("div",{className:"control has-icons-left"},s.a.createElement("input",{disabled:u.loading,required:!0,className:"input",onChange:j,value:u.title,type:"text",placeholder:"enter title..."}),s.a.createElement("span",{className:"icon is-small is-left"},s.a.createElement(I.d,null)))),s.a.createElement("div",{className:"field is-grouped is-grouped-centered"},s.a.createElement("div",{className:"control"},s.a.createElement("button",{onClick:function(){return p(Object(l.a)(Object(l.a)({},u),{},{showEdit:!1}))},disabled:u.loading,type:"reset",className:"button mt-4 is-dark is-outlined is-rounded is-uppercase"},s.a.createElement(I.b,null),"\xa0 Cancel")),s.a.createElement("div",{className:"control"},s.a.createElement("button",{disabled:u.loading,type:"submit",className:"button mt-4 is-success is-rounded is-uppercase ".concat(u.loading?"is-loading":"")},s.a.createElement(I.a,null),"\xa0 Save Changes")))):s.a.createElement("div",null,s.a.createElement("p",{style:{textOverflow:"ellipsis"},className:"block is-clipped is-size-5 has-text-centered has-text-weight-bold is-capitalized"},x.title),s.a.createElement("p",{style:{justifyContent:"space-between"},className:"is-capitalized is-flex block has-text-grey-light has-text-centered"},s.a.createElement("span",null,s.a.createElement(I.c,null),"\xa0 Created ",k.fromNow()),s.a.createElement("span",null,s.a.createElement(I.j,null),"\xa0 ",ie(x.reportsCount)," ",x.reportsCount>1?"reports":"report")),s.a.createElement("div",{className:"is-flex-centered"},s.a.createElement("div",{className:"field has-addons has-addons-centered"},s.a.createElement("div",{className:"control"},s.a.createElement(U.b,{to:"".concat(C).concat(t.id),target:"_blank",type:"button",className:"button is-small is-rounded is-uppercase"},"View Flags")),s.a.createElement("div",{className:"control"},s.a.createElement("button",{onClick:function(){return E(Object(l.a)(Object(l.a)({},u),{},{show:!0}))},disabled:u.loading,type:"button",className:"button is-small is-warning is-inverted is-rounded is-uppercase"},"Warn Account")))),s.a.createElement("div",{className:"columns is-vcentered is-mobile"},s.a.createElement("div",{className:"column is-narrow"},s.a.createElement("figure",{className:"image is-48x48",style:{margin:"auto"}},s.a.createElement("img",{className:"is-rounded",style:{height:"100%"},src:x.owner.profileImageURL}))),s.a.createElement("div",{className:"column pl-0"},s.a.createElement("p",{style:{textOverflow:"ellipsis"},className:"is-clipped is-size-6 has-text-left is-capitalized"},"".concat(x.owner.firstName," ").concat(x.owner.lastName))),s.a.createElement("div",{className:"column is-narrow field has-addons has-addons-right"},s.a.createElement("p",{className:"is-capitalized mx-2"},s.a.createElement(I.t,null)," ",ie(x.like)),s.a.createElement("p",{className:"is-capitalized mx-2"},s.a.createElement(I.s,null)," ",ie(x.dislike)),"video"===x.type?s.a.createElement("p",{className:"is-capitalized mx-2"},s.a.createElement(I.h,null)," ",ie(x.viewCount)):null)),s.a.createElement("div",{className:"field is-grouped is-grouped-centered"},s.a.createElement("div",{className:"control"},s.a.createElement("button",{onClick:a,disabled:u.loading,type:"button",className:"button mt-4 is-dark is-outlined is-rounded is-uppercase"},s.a.createElement(I.b,null),"\xa0 Back")),s.a.createElement("div",{className:"control"},s.a.createElement("button",{onClick:N,disabled:u.loading,type:"button",className:"button mt-4 is-danger is-rounded is-uppercase ".concat(u.loading?"is-loading":"")},s.a.createElement(I.u,null),"\xa0 Delete")),s.a.createElement("div",{className:"control"},s.a.createElement("button",{onClick:function(){return p(Object(l.a)(Object(l.a)({},u),{},{showEdit:!0}))},disabled:u.loading,type:"button",className:"button mt-4 is-success is-rounded is-uppercase"},s.a.createElement(I.m,null),"\xa0 Edit"))))))}var ue=function(e){var t=e.onSubmit,a=e.onBack,n=e.loading,c=(Object(r.useContext)(T),Object(r.useState)("This post violates the community guidelines of Karry!")),i=Object(o.a)(c,2),l=i[0],u=i[1];return s.a.createElement("form",{onSubmit:function(e){e.preventDefault(),e.stopPropagation(),t(l.trim())}},s.a.createElement(I.f,{className:"is-size-1 has-text-danger"}),s.a.createElement("div",{className:"field"},s.a.createElement("p",{className:"help block has-text-weight-bold is-size-6 is-uppercase"},"Send warning message"),s.a.createElement("div",{className:"control has-icons-left"},s.a.createElement("textarea",{disabled:n,required:!0,minLength:24,rows:4,className:"textarea",onChange:function(e){return u(e.target.value)},value:l,placeholder:"Set message to display to user about this warning..."}))),s.a.createElement("div",{className:"field is-grouped is-grouped-centered"},s.a.createElement("div",{className:"control"},s.a.createElement("button",{onClick:a,disabled:n,type:"reset",className:"button mt-4 is-dark is-outlined is-rounded is-uppercase"},s.a.createElement(I.b,null),"\xa0 Cancel")),s.a.createElement("div",{className:"control"},s.a.createElement("button",{disabled:n,type:"submit",className:"button mt-4 is-success is-rounded is-uppercase ".concat(n?"is-loading":"")},s.a.createElement(I.a,null),"\xa0 Send Warning"))))};Intl.NumberFormat();function de(e){var t=e.post,a=e.onClick,n=t.owner;return s.a.createElement("div",{onClick:a,className:"column is-3-widescreen is-4-desktop is-12-mobile is-6-tablet"},s.a.createElement("div",{className:"card is-hoverable-card"},s.a.createElement("div",{className:"card-content is-paddingless"},s.a.createElement("figure",{className:"image is-4by3",style:{margin:"auto"}},s.a.createElement("img",{src:t.thumbnailURL})),s.a.createElement("div",{className:"px-2 py-2"},s.a.createElement("p",{style:{textOverflow:"ellipsis"},className:"block is-clipped is-size-5 has-text-centered has-text-weight-bold is-capitalized"},t.title),s.a.createElement("div",{className:"columns is-vcentered is-mobile"},s.a.createElement("div",{className:"column is-narrow"},s.a.createElement("figure",{className:"image is-32x32",style:{margin:"auto"}},s.a.createElement("img",{className:"is-rounded",style:{height:"100%"},src:n.profileImageURL}))),s.a.createElement("div",{className:"column pl-0"},s.a.createElement("p",{style:{textOverflow:"ellipsis"},className:"is-clipped is-size-6 has-text-left is-capitalized"},"".concat(n.firstName," ").concat(n.lastName))),s.a.createElement("div",{className:"column pl-0 is-narrow"},"image"===t.type?s.a.createElement("p",{className:"is-capitalized"},s.a.createElement(I.t,null)," ",ie(t.like)):s.a.createElement("p",{className:"is-capitalized"},s.a.createElement(I.h,null)," ",ie(t.viewCount))))))))}function me(){var e=Object(r.useContext)(T),t=Object(r.useState)({loadingMore:!1,posts:new Array,selectedPost:void 0}),a=Object(o.a)(t,2),n=a[0],c=a[1],i=Object(W.useToasts)().addToast,u=Object(r.useCallback)(Object(m.a)(d.a.mark((function t(){var a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,c(Object(l.a)(Object(l.a)({},n),{},{loadingMore:!0})),t.next=4,le.getAllPosts(e,Math.max(2,Math.ceil(n.posts.length/20)+1));case 4:if(!((a=t.sent).length<1)){t.next=8;break}return i("No new data to fetch!",{appearance:"info"}),t.abrupt("return",c(Object(l.a)(Object(l.a)({},n),{},{loadingMore:!1})));case 8:c(Object(l.a)(Object(l.a)({},n),{},{loadingMore:!1,posts:[].concat(Object(te.a)(n.posts),Object(te.a)(a))})),t.next=16;break;case 11:t.prev=11,t.t0=t.catch(0),console.log(t.t0),c(Object(l.a)(Object(l.a)({},n),{},{loadingMore:!1})),i("Failed to load new data!",{appearance:"error"});case 16:case"end":return t.stop()}}),t,null,[[0,11]])}))),[n]);return Object(r.useEffect)((function(){c(Object(l.a)(Object(l.a)({},n),{},{loadingMore:!0}));le.getAllPosts(e).then((function(e){if(e.length<1)return i("No new data to fetch!",{appearance:"info"}),c(Object(l.a)(Object(l.a)({},n),{},{loadingMore:!1}));c(Object(l.a)(Object(l.a)({},n),{},{loadingMore:!1,posts:e}))})).catch((function(e){console.log(e),c(Object(l.a)(Object(l.a)({},n),{},{loadingMore:!1})),i("Failed to load new data!",{appearance:"error"})}))}),[]),s.a.createElement(he,null,s.a.createElement("div",{className:"container is-fluid mb-6"},s.a.createElement("div",{className:"section my-4"},s.a.createElement("div",{className:"columns is-multiline is-vcentered is-flex-centered"},n.posts.map((function(e){return s.a.createElement(de,{key:e.id,onClick:function(){c((function(t){return Object(l.a)(Object(l.a)({},t),{},{selectedPost:e})}))},post:e})})))),s.a.createElement("div",{onClick:u,className:"button is-size-7 px-5 is-uppercase is-rounded is-dark ".concat(n.loadingMore?"is-loading":"")},"Load More")),n.selectedPost?s.a.createElement(_,{active:!0,onDismiss:function(){return c(Object(l.a)(Object(l.a)({},n),{},{selectedPost:void 0}))}},s.a.createElement(oe,{onCancel:function(){return c(Object(l.a)(Object(l.a)({},n),{},{selectedPost:void 0}))},post:n.selectedPost})):null)}Intl.NumberFormat();function pe(e){var t=e.report;return s.a.createElement("div",{className:"column is-10 is-offset-1 is-12-mobile mx-6"},s.a.createElement("div",{className:"card"},s.a.createElement("div",{className:"card-content"},s.a.createElement("div",{className:"px-2 py-2 columns is-vcentered"},s.a.createElement("div",{className:"column is-narrow is-12-mobile"},s.a.createElement("div",{className:"columns is-vcentered is-mobile"},s.a.createElement("div",{className:"column is-narrow"},s.a.createElement("figure",{className:"image is-32x32",style:{margin:"auto"}},s.a.createElement("img",{className:"is-rounded",style:{height:"100%"},src:t.person.profileImageURL}))),s.a.createElement("div",{className:"column pl-0"},s.a.createElement("p",{style:{textOverflow:"ellipsis"},className:"is-clipped has-text-left has-text-centered-mobile is-capitalized"},"".concat(t.person.firstName," ").concat(t.person.lastName))))),s.a.createElement("div",{className:"column is-expanded is-12-mobile"},s.a.createElement("p",{className:"is-clipped is-size-6 has-text-weight-bold"},t.content))))))}function be(){var e=Object(r.useContext)(T),t=Object(r.useState)({loadingMore:!1,reports:new Array}),a=Object(o.a)(t,2),n=a[0],c=a[1],i=Object(W.useToasts)().addToast,u=Object(q.i)().id,p=Object(r.useCallback)(Object(m.a)(d.a.mark((function t(){var a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,c(Object(l.a)(Object(l.a)({},n),{},{loadingMore:!0})),t.next=4,le.getReports(e,u,Math.max(2,Math.ceil(n.reports.length/20)+1));case 4:if(!((a=t.sent).length<1)){t.next=8;break}return i("No new data to fetch!",{appearance:"info"}),t.abrupt("return",c(Object(l.a)(Object(l.a)({},n),{},{loadingMore:!1})));case 8:c(Object(l.a)(Object(l.a)({},n),{},{loadingMore:!1,reports:[].concat(Object(te.a)(n.reports),Object(te.a)(a))})),t.next=16;break;case 11:t.prev=11,t.t0=t.catch(0),console.log(t.t0),c(Object(l.a)(Object(l.a)({},n),{},{loadingMore:!0})),i("Failed to load new data!",{appearance:"error"});case 16:case"end":return t.stop()}}),t,null,[[0,11]])}))),[n]);return Object(r.useEffect)((function(){c(Object(l.a)(Object(l.a)({},n),{},{loadingMore:!0})),le.getReports(e,u).then((function(e){if(e.length<1)return i("No new data to fetch!",{appearance:"info"}),c(Object(l.a)(Object(l.a)({},n),{},{loadingMore:!1}));c(Object(l.a)(Object(l.a)({},n),{},{loadingMore:!1,reports:e}))})).catch((function(e){console.log(e),c(Object(l.a)(Object(l.a)({},n),{},{loadingMore:!0})),i("Failed to load new data!",{appearance:"error"})}))}),[]),u?s.a.createElement(he,null,s.a.createElement("div",{className:"container is-fluid mb-6"},s.a.createElement("div",{className:"section my-4"},s.a.createElement("div",{className:"columns is-multiline is-vcentered is-flex-centered"},n.reports.map((function(e){return s.a.createElement(pe,{key:e.id,report:e})})))),s.a.createElement("div",{onClick:p,className:"button is-size-7 px-5 is-uppercase is-rounded is-dark ".concat(n.loadingMore?"is-loading":"")},"Load More"))):s.a.createElement(he,{loading:!1},s.a.createElement("div",{className:"container is-fluid is-fullheight is-flex-centered"},s.a.createElement(X,{message:"Post not found",shadow:!1})))}var fe=function(){return s.a.createElement("div",{className:"is-flex-centered",style:{height:"100%",filter:"grayscale(1)"}},s.a.createElement("figure",{className:"image is-128x128"},s.a.createElement("img",{src:F.a})))},he=function(e){var t=e.loading,a=e.children;return s.a.createElement("div",{className:"App-Body"},t?s.a.createElement(fe,null):s.a.createElement(s.a.Fragment,null,a))},ve=function(e){var t=e.showLoading,a=(Object(r.useContext)(T),Object(r.useContext)(A));return t?s.a.createElement(he,{loading:!0}):s.a.createElement(q.d,null,s.a.createElement(q.b,{path:O,exact:!0},s.a.createElement(K,null)),s.a.createElement(q.b,{path:x,exact:!0},s.a.createElement(H,null)),s.a.createElement(q.b,{path:g,exact:!0},s.a.createElement(B,null)),s.a.createElement(J,{path:N},s.a.createElement(ee,null)),s.a.createElement(J,{path:j,exact:!0},s.a.createElement(ce,null)),s.a.createElement(J,{path:w,exact:!0},s.a.createElement(me,null)),s.a.createElement(J,{path:y},s.a.createElement(be,null)),s.a.createElement(q.b,{path:k,exact:!0},a.signedIn?s.a.createElement(q.a,{to:N}):s.a.createElement(q.a,{to:O})),s.a.createElement(J,null,s.a.createElement(he,{loading:t},s.a.createElement("div",{className:"container is-fluid is-fullheight is-flex-centered"},s.a.createElement(X,{message:"Page not found",shadow:!1})))))};var Ee=function(){var e=Object(r.useState)({ready:!1,loading:!1}),t=Object(o.a)(e,2),a=t[0],n=t[1],c=Object(r.useState)(void 0),i=Object(o.a)(c,2),u=i[0],d=i[1],m={setSignedInUser:d,signedIn:u,setLoading:function(e){return n(Object(l.a)(Object(l.a)({},a),{},{loading:e}))}};return Object(r.useEffect)((function(){S.ready.then((function(){S.signedIn()?d(S.user):d(void 0),n(Object(l.a)(Object(l.a)({},a),{},{ready:!0}))})).finally((function(){S.logoutListener=function(){return m.setSignedInUser(void 0)}}))}),[]),s.a.createElement(W.ToastProvider,{autoDismiss:!0,autoDismissTimeout:4e3,placement:"top-center"},s.a.createElement(T.Provider,{value:S},s.a.createElement(A.Provider,{value:m},s.a.createElement(R,{hidden:!a.ready}),s.a.createElement(ve,{showLoading:!a.ready||a.loading}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(s.a.createElement(s.a.StrictMode,null,s.a.createElement(U.a,{basename:"/karry-adminui"},s.a.createElement(Ee,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[237,1,2]]]);
//# sourceMappingURL=main.8fb68681.chunk.js.map